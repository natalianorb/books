<div class="card">
  <p-toast></p-toast>
  <p-confirmDialog></p-confirmDialog>

  <div class="flex justify-content-between align-items-center mb-3">
    <h2>Authors</h2>
    <p-button
      label="New Author"
      icon="pi pi-plus"
      (click)="openNew()"
    ></p-button>
  </div>

  <p-table
    [value]="authors"
    [tableStyle]="{ 'min-width': '50rem' }"
    [paginator]="true"
    [rows]="10"
    styleClass="p-datatable-gridlines"
    [rowHover]="true"
  >
    <ng-template pTemplate="header">
      <tr>
        <th>Name</th>
        <th>Birth Date</th>
        <th>Biography</th>
        <th style="width: 10rem">Actions</th>
      </tr>
    </ng-template>
    <ng-template pTemplate="body" let-author>
      <tr>
        <td>{{ author.name }}</td>
        <td>{{ author.birthDate | date }}</td>
        <td>
          {{ author.biography | slice : 0 : 100
          }}{{ author.biography?.length > 100 ? "..." : "" }}
        </td>
        <td>
          <div class="flex gap-2">
            <button
              pButton
              pRipple
              icon="pi pi-pencil"
              class="p-button-rounded p-button-success"
              (click)="editAuthor(author)"
              title="edit author"
            ></button>
            <button
              pButton
              pRipple
              icon="pi pi-trash"
              class="p-button-rounded p-button-danger"
              (click)="deleteAuthor(author)"
              title="delete author"
            ></button>
          </div>
        </td>
      </tr>
    </ng-template>
    <ng-template pTemplate="emptymessage">
      <tr>
        <td colspan="4" class="text-center">No authors found.</td>
      </tr>
    </ng-template>
  </p-table>
</div>

<p-dialog
  [(visible)]="displayDialog"
  [style]="{ width: '450px' }"
  [header]="selectedAuthor ? 'Edit Author' : 'New Author'"
  [modal]="true"
  styleClass="p-fluid py-2"
>
  <app-create-author
    [author]="selectedAuthor"
    (save)="saveAuthor($event)"
    (cancel)="hideDialog()"
  >
  </app-create-author>
</p-dialog>
